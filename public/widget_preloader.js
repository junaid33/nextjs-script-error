jdgm=window.jdgm||{},jdgm.CACHE_SERVER_HOST="https://cache.judge.me",jdgm.HTTPS_HOST="https://judge.me",jdgm.CDN_HOST="https://cdn.judge.me/",jdgm.SHOP_DOMAIN='powertoolexpress.myshopify.com',jdgm.PLATFORM='shopify',jdgm.PUBLIC_TOKEN='AMiVbbTRcKCzhRhgsJobroaS0fc',window.jdgmCacheServer||(jdgmCacheServer={},function(){var cacheMetafieldsUrl=jdgm.CACHE_SERVER_HOST+"/widgets/"+jdgm.PLATFORM+"/"+jdgm.SHOP_DOMAIN,parseHTML=function(e){var t=document.createElement("div");return t.innerHTML=e,t.children},appendHTML=function(e,t){for(;t.length>0;)e.appendChild(t[0])},formatParams=function(e){return"?"+Object.keys(e).map(function(t){return t+"="+encodeURIComponent(e[t])}).join("&")},requestCacheServer=function(e,t){var n=new XMLHttpRequest;n.open("GET",cacheMetafieldsUrl+formatParams(e),!0),n.onreadystatechange=function(){if(4===n.readyState)if(n.status>=200&&n.status<400){var e=JSON.parse(n.responseText);t(e)}else console.warn("Cannot load Judge.me widget contents due to caching server error."),console.log(n)},n.onerror=function(){console.warn("Cannot load Judge.me widget contents due to caching server error."),console.log(n)},n.send()},fillContentToWidget=function(e,t,n){Array.prototype.forEach.call(e,function(e){n?appendHTML(e,parseHTML(t[e.getAttribute("data-id")])):appendHTML(e,parseHTML(t))})};jdgmCacheServer._loadAll=function(){return"undefined"!=typeof jdgmSettings?(console.warn("Widget already loaded."),!1):void loadContent(!0)};var loadContent=function(firstRequest){var previewBadges=document.querySelectorAll(".jdgm-preview-badge"),reviewWidget=document.querySelectorAll(".jdgm-review-widget"),reviewTab=document.querySelectorAll(".jdgm-revs-tab"),allReviewsPage=document.querySelectorAll(".jdgm-all-reviews-widget"),featuredCarousel=document.querySelectorAll(".jdgm-carousel-wrapper"),allReviewsRating=document.querySelectorAll(".jdgm-all-reviews-rating"),allReviewsCount=document.querySelectorAll(".jdgm-all-reviews-count"),verifiedBadge=document.querySelectorAll(".jdgm-verified-badge-wrapper"),data={public_token:jdgm.PUBLIC_TOKEN};if(previewBadges.length>0){var badgeArray=Array.from(previewBadges),previewBadgeProductIds=badgeArray.map(function(e){return e.getAttribute("data-id")}).join(",");data.preview_badge_product_ids=previewBadgeProductIds}if(reviewWidget.length>0){var widgetArray=Array.from(reviewWidget),reviewWidgetProductIds=widgetArray.map(function(e){return e.getAttribute("data-id")}).join(",");data.review_widget_product_ids=reviewWidgetProductIds}reviewTab.length>0&&(data.reviews_tab=1,data.all_reviews_rating=1,data.all_reviews_count=1),featuredCarousel.length>0&&(data.featured_carousel=1,data.all_reviews_rating=1,data.all_reviews_count=1),allReviewsPage.length>0&&(data.all_reviews_page=1),verifiedBadge.length>0&&(data.verified_badge=1),allReviewsCount.length>0&&(data.all_reviews_count=1),allReviewsRating.length>0&&(data.all_reviews_rating=1),requestCacheServer(data,function(response){if(firstRequest){var settings=parseHTML(response.settings);Array.prototype.forEach.call(settings,function(e){if("jdgm-settings-script"===e.className)eval(e.text);else if("text/javascript"===e.type){var script=document.createElement("script");script.id=e.id,script.src=e.src,document.head.appendChild(script)}else document.head.appendChild(e.cloneNode(!0))});var htmlMiracle=parseHTML(response.html_miracle);appendHTML(document.head,htmlMiracle)}if(data.preview_badge_product_ids&&fillContentToWidget(previewBadges,response.preview_badges,!0),data.review_widget_product_ids&&fillContentToWidget(reviewWidget,response.review_widgets,!0),data.reviews_tab&&fillContentToWidget(reviewTab,response.reviews_tab,!1),data.featured_carousel&&fillContentToWidget(featuredCarousel,response.featured_carousel,!1),data.verified_badge&&fillContentToWidget(verifiedBadge,response.verified_badge,!1),data.all_reviews_page&&Array.prototype.forEach.call(allReviewsPage,function(e){for(var t=parseHTML(response.all_reviews),n=parseHTML(response.all_reviews_header);t.length>0;)e.querySelector(".jdgm-all-reviews__body").appendChild(t[0]);for(;n.length>0;)e.insertBefore(n[0],e.querySelector(".jdgm-all-reviews__body"))}),data.all_reviews_rating&&Array.prototype.forEach.call(allReviewsRating,function(e){e.setAttribute("data-score",response.all_reviews_rating)}),data.all_reviews_count&&Array.prototype.forEach.call(allReviewsCount,function(e){e.innerHTML=response.all_reviews_count}),firstRequest){var mainJsScript=document.createElement("script");mainJsScript.src=jdgm.CDN_HOST+"judgeme_widget_v2.js",mainJsScript.id="judgeme_widget_v2_js",document.head.appendChild(mainJsScript);var mainCssScript=document.createElement("link");mainCssScript.type="text/css",mainCssScript.rel="stylesheet",mainCssScript.id="judgeme_widget_v2_css",mainCssScript.href=jdgm.CDN_HOST+"judgeme_widget_v2.css",document.head.appendChild(mainCssScript)}})};jdgmCacheServer.reloadPreviewBadges=function(){var e=document.querySelectorAll(".jdgm-preview-badge:not(.jdgm--done-setup)"),t={public_token:jdgm.PUBLIC_TOKEN};if(e.length>0){var n=Array.from(e),i=n.map(function(e){return e.getAttribute("data-id")}).join(",");t.preview_badge_product_ids=i}requestCacheServer(t,function(n){t.preview_badge_product_ids&&fillContentToWidget(e,n.preview_badges,!0),"function"==typeof jdgm.customizeBadges?jdgm.customizeBadges():console.log("Core JS are not loaded yet.")})};var clearAll=function(){var e=document.head.getElementsByClassName("jdgm-settings-style"),t=document.head.getElementsByClassName("jdgm-miracle-styles"),n=document.getElementById("judgeme_widget_v2_css"),i=document.getElementById("judgeme_widget_v2_js"),r=document.getElementsByClassName("jdgm-random-link"),o=document.getElementById("judgeme_widget_leex_css"),a=document.getElementById("judgeme_widget_leex_js"),s=document.getElementById("judgeme_widget_align_css");jdgm.$(".jdgm--done-setup").removeClass("jdgm--done-setup"),e.length>0&&e[0].remove(),t.length>0&&t[0].remove(),r.length>0&&r[0].remove(),i&&i.remove(),n&&n.remove(),a&&a.remove(),o&&o.remove(),s&&s.remove(),jdgm._doneSetup=null};jdgmCacheServer.reloadAllWidgets=function(){loadContent(!1)},jdgmCacheServer.reloadAll=function(){clearAll(),loadContent(!0)},shopbasePageLoad=function(){"shopbase"==jdgm.PLATFORM&&window.sbsdk.$on("page_load",function(){setTimeout(jdgmCacheServer.reloadAll,0)})};var documentReady=function(e){(document.attachEvent?"complete"===document.readyState:"loading"!==document.readyState)?e():document.addEventListener("DOMContentLoaded",e)};documentReady(function(){return jdgm.PLATFORM&&jdgm.SHOP_DOMAIN?(jdgmCacheServer._loadAll(),void shopbasePageLoad()):(console.warn("Cannot load Judge.me widget contents due to missing jdgm key. Check value of jdgm.PLATFORM, jdgm.SHOP_DOMAIN, jdgm.PUBLIC_TOKEN respectively:",jdgm.PLATFORM,jdgm.SHOP_DOMAIN,jdgm.PUBLIC_TOKEN),!1)})}());